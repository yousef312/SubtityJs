var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(l){return l.raw=l};$jscomp.createTemplateTagFirstArgWithRaw=function(l,a){l.raw=a;return l};
(function(l,a){"uses strict";"function"===typeof define&&define.amd?define([],build):"object"===typeof module&&module.exports?module.exports=a():l.Subtity=a()})(this,function(){function l(){this.subs=[];this.text=this.title="";this.subtitles=[];this.ranges=[];this.current=0;this.subtitlesCounts=null;this.offset=0;this.style={family:"Arial",size:19,lineSpacing:5,color:"rgb(255,255,255)",align:"center",direction:"ltr",outlineColor:"rgb(0,0,0)",outlineSize:1,shadowColor:"rgba(0,0,0,0)",opacity:1,shadowBlur:0,
shadowX:0,shadowY:0,base:90,left:50,weight:""};this.video=this.mode=this.container=this.renderer=null;this.ctx=document.createElement("canvas").getContext("2d");this.activated=!1}l.prototype={reset:function(){this.offset=this.current=0;this.style={family:"Arial",size:19,lineSpacing:10,color:"rgb(255,255,255)",align:"center",direction:"ltr",outlineColor:"rgb(0,0,0)",outlineSize:1,shadowColor:"rgba(0,0,0,0)",shadowBlur:0,opacity:1,shadowX:0,shadowY:0,base:90,left:50,weight:""};this.subtitles=[];this.ranges=
[];this.activated=!1;this.title=""},use:function(a){var b=this,c=this.subs.findIndex(function(f){return f.title===a});if(-1!==c){if(""!==this.title){var e=this.subs.findIndex(function(f){return f.title===b.title});this.subs[e].used=!1}this.current=0;this.reset();this.subs[c].used=!0;this.title=this.subs[c].title;this.ranges=this.subs[c].ranges;this.subtitles=this.subs[c].subtitles;this.text=this.subs[c].text;this.subtitlesCounts=this.subs[c].count;this.activated=!0;this.calcFontHeight()}},parseSRT:function(a,
b,c){var e=a.split("\n");a={movie:c,title:b,ranges:[],subtitles:[],text:a,count:0};b=!1;c=[];for(var f=0;f<e.length;f++){var d=e[f];1==d.length&&(b=!1,a.subtitles.push(c),c=[]);-1!==d.indexOf("--\x3e")?(a.ranges.push(this.getSeconds(d)),b=!0):!0===b&&1!==d.length&&c.push(d)}a.count=a.subtitles.length;this.subs.push(a)},parseWEBVTT:function(a,b,c){a=a.split("\n");var e=!1;b={movie:c,title:b,ranges:[],subtitles:[]};c=[];for(var f=0;f<a.length;f++){var d=a[f];-1===d.indexOf("NOTE ")&&-1===d[0].indexOf("NOTE\n")&&
(e&&1!==d.length&&c.push(d),-1!==d.indexOf("--\x3e")?(e=this.getSeconds(d),b.ranges.push(e),e=!0):1===d.length&&!0===e&&(e=!1,b.subtitles.push(c),c=[]))}b.count=b.subtitles.length;this.subs.push(b)},parseSBV:function(a,b,c){a=a.split("\n");var e=!1,f=!1,d=-1;b={movie:c,title:b,ranges:[],subtitles:[]};1===a[0].length&&(e=!0);for(c=0;c<a.length;c++){var g=a[c];!0===f&&1!==g.length&&b.subtitles[d].push(g);!0===e&&(b.ranges.push(this.getSeconds(g)),e=!1,f=!0,d++,b.subtitles[d]=[]);1===g.length&&(e=!0,
f=!1)}b.count=b.subtitles.length;this.subs.push(b)},parseSSA:function(a,b,c){a=a.split("\n");var e=null,f=null;b={movie:c,title:b,ranges:[],subtitles:[],count:null};for(c=0;c<a.length;c++){var d=a[c];if("["===d[0])f=d.substr(1,d.indexOf("]")-1).toLowerCase();else if("events"===f){d=d.split(":");if(2<d.length){for(var g=2;g<d.length;g++)d[1]+=":"+d[g];d.splice(2,d.length)}g=d[0].toLowerCase();d=d[1];"format"===g?e=d.toLowerCase().split(","):"dialogue"===g&&(d=d.split(","),k=e.findIndex(function(h){return"text"===
h.trim()}),g=d[k],i0=e.findIndex(function(h){return"start"===h.toLowerCase().trim()}),i1=e.findIndex(function(h){return"end"===h.toLowerCase().trim()}),t1=this.convertToTime(d[i0]),t2=this.convertToTime(d[i1]),b.ranges.push([t1,t2]),b.subtitles.push([g]))}}b.count=b.subtitles.length;this.subs.push(b)},parseITT:function(a,b,c){a=a.split("<body>")[1].split("</body>")[0].split("<p ");b={movie:c,title:b,ranges:[],subtitles:[],count:null};for(c=0;c<a.length;c++)if("b"===a[c][0]){var e=a[c].split(">");
var f=e[0].split('"');f=[this.convertToTime(f[1]),this.convertToTime(f[3])];f[1]+=f[0];e.shift();for(var d="",g=0;g<e.length;g++){var h=e[g].replace("<br","\n");for(var m=0;m<h.length&&"<span"!==h[m]+h[m+1]+h[m+2]+h[m+3]+h[m+4]&&"</"!==h[m]+h[m+1];m++)d+=h[m]}d=d.split("\n");b.ranges.push(f);b.subtitles.push(d)}b.count=b.subtitles.length;this.subs.push(b)},convertToTime:function(a){var b=a.split(":");b[2]=b[2].replace(",",".");if(3===b.length){a=parseFloat(b[0]);var c=parseFloat(b[1]);b=parseFloat(b[2])}else a=
0,c=parseFloat(b[0]),b=parseFloat(b[1]);return 0+(3600*a+60*c+b)},getSeconds:function(a){var b=[0,0];a=-1===a.indexOf("--\x3e")?a.split(","):a.split("--\x3e");b[0]=this.convertToTime(a[0]);b[1]=this.convertToTime(a[1]);return b},update:function(){if(null===this.mode)console.warn("Must set up the parser rendering mode first!`Subtity.setUp2D or Subtity.setUpContainer`");else if(0!==this.ranges.length&&0!==this.subtitles.length&&!1!==this.activated){current=this.video.currentTime;mov=this.video.src;
for(var a=0;a<this.ranges.length;a++){var b=this.ranges[a],c=this.subtitles[a];current-=this.offset;if(current>=b[0]&&current<=b[1])if(this.current=a,1===this.mode)this.container.innerText=this.subtitles[this.current];else{family=this.style.family||"Arial";base=this.style.base||90;left=this.style.left||50;size=this.style.size||25;align=this.style.align||"center";color=this.style.color||"white";bg=this.style.bg||"rgba(0,0,0,0)";direction=this.style.direction||"ltr";opacity=this.style.opacity||1;weight=
this.style.weight||"bold";marginL=this.style.marginLeft;marginT=this.style.marginTop;outlineColor=this.style.outlineColor||"black";outlineSize=this.style.outlineSize||1;shadowColor=this.style.shadowColor||"rgba(0,0,0,0)";shadowX=this.style.shadowX||0;shadowY=this.style.shadowY||0;shadowBlur=this.style.shadowBlur||0;lineSpacing=this.style.lineSpacing||0;lineHeight=this.style.lineHeight;this.renderer.beginPath();x=this.renderer.canvas.width/100*left;y=this.renderer.canvas.height/100*base;this.renderer.fillStyle=
color;this.renderer.textAlign=align;this.renderer.direction=direction;this.renderer.font=weight+" "+size+"px "+family;this.renderer.shadowColor=shadowColor;this.renderer.shadowBlur=shadowBlur;this.renderer.shadowOffsetX=shadowX;this.renderer.shadowOffsetY=shadowY;this.renderer.globalAlpha=opacity;for(b=c.length-1;-1<b;b--){var e=c[b];this.renderer.strokeStyle=outlineColor;this.renderer.lineWidth=2*outlineSize;this.renderer.strokeText(e,x,y);this.renderer.lineWidth=1;this.renderer.fillText(e,x,y);
y-=lineHeight+lineSpacing}this.renderer.closePath()}}}},setUp2D:function(a,b){this.renderer=a instanceof CanvasRenderingContext2D?a:a.getContext("2d");this.mode=2;this.video=b},setUpContainer:function(a,b){this.container=a;this.mode=1;this.video=b},setOffset:function(a){this.offset="number"!==typeof a||isNaN(a)?this.offset:a},set:function(a,b){switch(a){case "family":this.style.family=b;this.calcFontHeight();break;case "color":this.style.color=b;break;case "weight":this.style.weight=b;break;case "size":this.style.size=
parseFloat(b);this.calcFontHeight();break;case "align":this.style.align=b;break;case "direction":this.style.direction=b;break;case "shawX":this.style.shadowX=parseFloat(b);break;case "shawY":this.style.shadowY=parseFloat(b);break;case "shawBlur":this.style.shadowBlur=b;break;case "shawColor":this.style.shadowColor=b;break;case "bg":this.style.bg=b;break;case "outlineColor":this.style.outlineColor=b;break;case "outlineSize":this.style.outlineSize=parseFloat(b);break;case "lineSpacing":this.style.lineSpacing=
parseFloat(b);break;case "base":this.style.base=parseFloat(b);break;case "left":this.style.left=parseFloat(b);break;case "opacity":this.style.opacity=isNaN(parseFloat(b))?1:parseFloat(b)}},calcFontHeight:function(){fontSize=parseFloat(this.style.size);fontFamily=this.style.family;var a=this.ctx;a.canvas.width=a.canvas.width;a.fillRect(0,0,a.canvas.width,a.canvas.height);a.textBaseline="top";a.font=fontSize+"px "+fontFamily;a.fillStyle="white";a.fillText("gM",0,0);for(var b=a.getImageData(0,0,a.canvas.width,
a.canvas.height).data,c=-1,e=-1,f=0;f<a.canvas.height;f++)for(var d=0;d<a.canvas.width;d++)if(0===b[4*(f*a.canvas.width+d)]){if(d===a.canvas.width-1&&-1!==c){e=f;f=a.canvas.height;break}}else{-1===c&&(c=f);break}this.style.lineHeight=e-c},loadDefaultStyle:function(){this.style={family:"Arial",size:19,lineSpacing:10,color:"rgb(255,255,255)",align:"center",direction:"ltr",outlineColor:"rgb(0,0,0)",outlineSize:1,shadowColor:"rgba(0,0,0,0)",opacity:1,shadowBlur:0,shadowX:0,shadowY:0,base:90,left:50,weight:""};
this.offset=0},toggleActivation:function(a){return this.activated="boolean"===typeof a?a:!this.activated},remove:function(a){var b=this.subs.findIndex(function(c){return c.title===a});return-1!==b?(!0===this.subs[b].used&&this.reset(),this.subs.splice(b,1)):!1},add:function(a,b,c,e){"string"===typeof c&&"string"===typeof b&&""!==a&&!1!==this.check(a)&&(c=c.toLowerCase(),".srt"===c||"srt"===c?this.parseSRT(b,a,e):".sbv"===c||"sbv"===c?this.parseSBV(b,a,e):".itt"===c||"itt"===c?this.parseITT(b,a,e):
".webvtt"===c||"webvtt"===c?this.parseWEBVTT(b,a,e):(".ssa"===c||"ssa"===c)&&this.parseSSA(b,a,e))},check:function(a){return-1!==this.subs.findIndex(function(b){return b.title===a})?(console.warn("The given title( "+a+") is already under use, please use a new one"),!1):!0}};return l});